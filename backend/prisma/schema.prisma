generator client {
  provider   = "prisma-client"
  output       = "../generated/prisma"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model activities {
  id         String     @id
  ownerId    String    @map("owner_id")
  habitId    String    @map("habit_id")
  caption    String
  mediaUrls  String[]  @map("media_urls")
  isPublic   Boolean   @default(false) @map("is_public")
  createdAt  DateTime  @default(now()) @db.Timestamptz(6) @map("created_at")
  updatedAt  DateTime  @db.Timestamptz(6) @map("updated_at")
  habits     habits    @relation(fields: [habitId], references: [id], onDelete: Cascade)
  comments   comments[]
  likes      likes[]
  views      views[]
}

model comments {
  id           String     @id
  ownerId      String    @map("owner_id")
  commentText  String    @map("comment_text")
  activityId   String    @map("activity_id")
  createdAt    DateTime  @default(now()) @db.Timestamptz(6) @map("created_at")
  activities   activities @relation(fields: [activityId], references: [id], onDelete: Cascade)
  replies replies[]
  likes commentLikes[]
}

model commentLikes {
  id         String    @id @default(uuid())
  ownerId    String    @map("owner_id")
  commentId  String    @map("comment_id")
  createdAt  DateTime  @default(now()) @db.Timestamptz(6) @map("created_at")
  comments   comments  @relation(fields: [commentId], references: [id], onDelete: Cascade)

  @@unique([ownerId, commentId])
}

model replies {
  id         String   @id @default(uuid())
  ownerId    String   @map("owner_id")
  replyText  String   @map("reply_text")
  commentId  String   @map("comment_id")
  createdAt  DateTime @default(now()) @db.Timestamptz(6) @map("created_at")
  updatedAt  DateTime @db.Timestamptz(6) @map("updated_at")
  comments   comments @relation(fields: [commentId], references: [id], onDelete: Cascade)
}

model habits {
  id          String       @id
  ownerId     String      @map("owner_id")
  title       String
  description String
  isPublic    Boolean     @default(false) @map("is_public")
  createdAt   DateTime    @default(now()) @db.Timestamptz(6) @map("created_at")
  updatedAt   DateTime    @db.Timestamptz(6) @map("updated_at")
  activities  activities[]
}

model likes {
  id          String     @id
  ownerId     String    @map("owner_id")
  activityId  String    @map("activity_id")
  createdAt   DateTime  @default(now()) @db.Timestamptz(6) @map("created_at")
  activities  activities @relation(fields: [activityId], references: [id], onDelete: Cascade)

  @@unique([ownerId, activityId])
}

model views {
  id          String     @id
  activityId  String    @map("activity_id")
  createdAt   DateTime  @default(now()) @db.Timestamptz(6) @map("created_at")
  ownerId     String    @map("owner_id")
  activities  activities @relation(fields: [activityId], references: [id], onDelete: Cascade)

  @@unique([ownerId, activityId])
}
